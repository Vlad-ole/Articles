After-pulsing and cross-talk comparison for KETEK PM1125NS-SB0, Hamamatsu S10362-11-100C and Hamamatsu S13360-3050CS.

\section{Abstract}
Silicon photomultipliers (SiPM) have become widespread at present.
They exceed photomultipliers on quantum efficiency, size and resistance to the magnetic field.
However, due to the peculiarities of the structure they have a greater value of dark noise, as well as have additional sources of noise: cross-talk and after-pulsing.
In addition, these parameters may have a temperature dependence.

In this article one study the dark noise, the probability of cross-talk and after-pulsing at different voltages and temperatures for two modern SiPM: Hamamatsu S13360-3050CS and KETEK PM1125NS-SB0 and Hamamatsu S10362-11-100C SiPM from previous generation.
Offline signal processing was performed by the pulse approximation with reconstruction of the amplitudes
and start time to find these parameters.
As a result, we found that in achieved measurement accuracy dark noise has temperature and voltage dependence, but cross-talk and after-pulsing probabilities have only the latter. 

The measured cross-talk probability for KETEK PM1125NS-SB0 and Hamamatsu S13360-3050CS at their operating voltage is about 6\%
which is two times smaller than that for Hamamatsu S10362-11-100C.
The total after-pulsing probability (fast component) for KETEK PM1125NS-SB0 and Hamamatsu S13360-3050CS is about 12\%, which is also almost 2 times smaller than that for Hamamatsu S10362-11-100C (fast and slow component).
Dark noise rate for Hamamatsu S13360-3050CS at $ 20 \; ^{\circ}C $ is only $ 30 \; kHz / mm ^ 2 $ in comparison with $ 80 \; kHz / mm ^ 2 $ for KETEK PM1125NS-SB0.

\section{Introduction}
BINP many years engaged in the development of X-ray inspection systems \cite{SiPM based photon counting detector for scanning digital radiography}.
These installations can be used in various fields: inspection at airports, subway or in the workplace.
Multistrip ionization chamber filled with pure Xe at 15 bar have been used as X-ray detector until now.
However, this detector has a serious disadvantage - it works in the integrating mode, so at low input flow of particles electronic noise seriously degrades quality of the images.
Another disadvantage is the insufficiently high detection efficiency of high-energy photons.
In this regard, it was decided to choose a new detector based on SiPM and scintillator which may have the detection efficiency > 90 \% and operate in the mode of direct photon counting.

The main purpose of this work is to measure the after-pulsing and cross-talk probabilities for two SiPM: KETEK PM1125NS-SB0 and Hamamatsu S13360-3050CS and compare them with the characteristics of  Hamamatsu S10362-11-100C - the previous generation SiPM.
\section{Measurement of breakdown voltage}
One of the important characteristics of any SiPM is the breakdown voltage.
Breakdown voltage $ V_ {BD} $ is the voltage at which the gain equals to zero.

In many works are shown that various SiPMs gain is a linear function of both temperature and voltage.
Thus, the expression for the gain $ G (V, T) $ is written as follows: \cite{Silicon Photomultiplier's Gain Stabilization, Temperature and Bias Voltage Dependence, Characterization of SiPM: temperature dependencies, Characterisation of a silicon photomultiplier device}:

\begin{eqnarray}\label{eq:G(V, T)}
G(V, T) = a \cdot V + b \cdot T + c
\end{eqnarray}

It is easy to find the breakdown voltage equating the gain from Eq.(\ref{eq:G(V, T)}) to zero :
\begin{eqnarray}\label{eq:V_bd(T)}
V_{BD}(T) = \frac{-(b \cdot T + c)}{a} = \frac{dV}{dT} \cdot T + const
\end{eqnarray}

The following installation was assembled for measurement of breakdown voltage and gain (Fig.~\ref{image:install_V_bd}).
The light source based on fast LED (CAEN SP5601) sends a flash through an optical fiber on SiPM.
At the same time, the light source sends a trigger signal to the CAEN DT5720A ADC.
The signal from the SiPM passes through the amplifier to the CAEN DT5720A, which integrates the signal in the presence of the trigger signal.
The resulting charge is transmitted to computer in on-line mode.
SiPM is mounted on a thermoelectric cooler and the temperature stabilization is ensured by TRM 101 PID - controller.
The deviation from the set temperature does not exceed 1K.
\begin{figure}[h]
\center{\includegraphics[width=8cm]{install_V_bd_11}}
\caption{Installation scheme for measurement the SiPM breakdown voltage.}
\label{image:install_V_bd}
\end{figure}

The calculation of the breakdown voltage had several stages.
The intensity of the light source was set so that there were not SiPM triggering or single photon was registered in generally.
The signal was integrated into the gate with 200 ns duration ($\approx 5 \cdot \tau$).
Then the top of the noise peak and the peak from the registration of a single photon was approximated by a Gaussian function.
We calculated the distance $\Delta$ between the 0th and the 1st peak.
Distances between the first and the second, the second and the third etc. peaks were not considered.
The main reason was that as the number of peak increased the greater became the discrepancy between the true and measured peak position because of after-pulses.
An example of charge spectrum is shown in Fig.~\ref{image:sipm_spectrum}.
In the measurements the error voltage $\Delta V$ was estimated at 0.01 V, and the temperature error of $\Delta T$ was estimated as the minimum temperature step 1 K divided by $\sqrt{12}$.

\begin{figure}[h]
\center{\includegraphics[width=8cm]{sipm_spectrum_eng}}
\caption{Spectrum from Hamamatsu S13360-3050CS at a voltage of 71 V and a temperature of 270 K under irradiation by LED.
The integration time is 300 ns.}
\label{image:sipm_spectrum}
\end{figure}

The value $\Delta$ associated with a gain as follows:
$$G = \Delta \cdot ADC_{\text{conversion rate}} / \text{charge of electron},$$
where $ADC_{\text{conversion rate}} [C  / (mV \cdot s)] $ - conversion coefficient.
To determine the conversion coefficient a rectangular pulse from generator was sent to the test input of the amplifier through the capacitance $C = 1 pF$.
After tract calibration all measurements $G(V, T)$ were approximated by Eq.(\ref{eq:G(V, T)}) to find $a$, $b$, $c$ parameters.
Then using Eq.(\ref{eq:V_bd(T)}) we found the dependence of breakdown voltage on temperature. 

\section{Сross-talk and after-pulsing probabilities finding algorithm}
\subsection{Theory}
There are several algorithms for finding cross-talk probabilities.
One of them is described in \cite{Characterisation Studies of Silicon Photomultipliers}.
The idea is to measure the dark noise frequency at different thresholds.
Cross-talk probability can be defined as the ratio of the frequencies with 1.5 photoelectrons(phe) and 0.5 photoelectrons threshold:
\begin{eqnarray}\label{eq:X_talk}
P_{X-talk} = \nu_{1.5 phe} / \nu_{0.5 phe}
\end{eqnarray}
However, this method has a significant disadvantage: after-pulses are indistinguishable from cross-talk if the former above the threshold.
Furthermore, this algorithm does not use information about the signal form, which makes the frequency dependence of the threshold more blurred and
complicates finding the value of $ \nu_{1.5 pe}$.

Advanced algorithm should use information about the waveform.
There are two approaches to signal processing: inverse convolution \cite{Modeling crosstalk in silicon photomultipliers} and an approximation of the original signal \cite{Characterization and Simulation of the Response, After-pulsingandcross-talkinmulti-pixelphotoncounters, Using MPPCs for T2K Fine Grain Detector}.
In this article we decided to use the method of signal approximation, because it is described in more detail in the above works.

In the process of approximation we obtain the amplitude signal and start time of signal.
Using this information we can recover the time constant and probability for after-pulses.

After-pulsing is repeated triggering of the cell, which occurs in some time moment after it is triggering.
The reason of after-pulsing is the capture of electrons into the traps during avalanche and their subsequent release after a time interval from a few nanoseconds to several microseconds \cite{Characterisation Studies of Silicon Photomultipliers}.
After triggering of the primary signal voltage in the cell decreases to the breakdown voltage and then will recover to its original value exponentially:
\begin{eqnarray}\label{eq:V_current}
V(\Delta t) = V_{bias} \cdot (1 - \exp \left( -\Delta t / \tau_{rec} \right)),
\end{eqnarray}
where $V_{bias}$ - SiPM operating voltage, $\tau_{rec}$ - the recovery time of the cell.

There are several processes, which may cause of the cell re-triggering.
First of all, it is after-pulsing.
Because of the different physical mechanisms of electron traps, there are two types of after-pulses:
fast and slow \cite{After-pulsingandcross-talkinmulti-pixelphotoncounters, Using MPPCs for T2K Fine Grain Detector, Characterization and Simulation of the Response}.
Secondly, dark currents may cause of the cell re-triggering
Each of the two processes has exponential time distribution with its own time constant $\tau$:
\begin{eqnarray}\label{eq:f(dt)_afterpulsing}
f(\Delta t) = \frac{1}{\tau} \cdot \exp(-\Delta t / \tau),
\end{eqnarray}
where $\tau$ - the average time elapsing between two pulses when considering only one of the above effects.
Measuring the distance between the signals we build pulse interval spectrum.
Then we approximate the probability density of the pulse interval by analytic function.
Function parameters characterize the time constants and probabilities of the processes leading to the triggering.

Since we are interested in the pulse interval density, it is necessary to know the probability $P(t)$ that on the interval from $0$ to $t$ не должно быть импульсов, а на участке от $t$ до $t + \delta t$ должен произойти один импульс.

Если рассматривать лишь один экспоненциальный процесс, то эта вероятность есть $P_{exp}(t) =  \nu \cdot e^{- t \cdot \nu} \cdot \delta t$.

Выведем плотность вероятности для временных интервалов, если в ячейке могут происходить послеимпульсы или темновые импульсы.
Для начала рассмотрим случай, когда имеются послеимпульсы только одного типа, происходящие с вероятностью $p$ и частотой $\nu$.
Темновые импульсы, как и послеимпульсы имеют экспоненциальное распределение (\ref{eq:f(dt)_afterpulsing}).
Поскольку темновые импульсы не зависят от послеимпульсов, то искомую вероятность $P(t)$ можно записать следующим образом:

\begin{eqnarray}\label{eq:probability_dt_simple}
P(t) = P\{ \text{нет послеимпульсов от $0$ до $t + \delta t$} \}
\cdot P\{ \text{есть темновой импульс от $t$ до $t + \delta t$} \} +  \\ \nonumber
P\{ \text{есть послеимпульс от $t$ до $t + \delta t$} \}
\cdot P\{\text{нет темнового импульса от $0$ до $t + \delta t$} \}
\end{eqnarray}

Вклад каждого из процессов будет следующий:
\begin{eqnarray}\label{eq:probability_dt_simple_parts}
P\{ \text{нет послеимпульсов от $0$ до $t + \delta t$} \} = (1 - p) + p \cdot e^{- \nu \cdot t} \\ \nonumber
P\{ \text{есть темновой импульс от $t$ до $t + \delta t$} \} = (\nu_{dc} \cdot e^{- \nu_{dc} \cdot t}) \cdot \delta t \\ \nonumber
P\{ \text{есть послеимпульс от $t$ до $t + \delta t$} \} = p \cdot ( \nu \cdot e^{- \nu \cdot t} ) \cdot \delta t  \\ \nonumber
P\{\text{нет темнового импульса от $0$ до $t + \delta t$} \} = e^{- \nu_{dc} \cdot t} \\ \nonumber
\end{eqnarray}

Таким образом, подставив значения вероятностей из (\ref{eq:probability_dt_simple_parts}) в (\ref{eq:probability_dt_simple}) и сократив итоговое выражение на $\delta t$, получим плотность вероятности временных интервалов:
\begin{eqnarray}\label{eq:probability_dt_fast}
f(t) = p \cdot (\nu + \nu_{dc}) \cdot e^{-(\nu + \nu_{dc}) \cdot t} + (1 - p) \cdot \nu_{dc} \cdot e^{-\nu_{dc} \cdot t}
\end{eqnarray}

Стоит отметить, что аналогичная формула приведена в \cite{Using MPPCs for T2K Fine Grain Detector}, однако с опечаткой в знаке между слагаемыми.

В итоге при учете быстрых и медленных послеимпульсов и темновых токов плотность вероятности распределения временных интервалов запишется следующим образом:
\begin{eqnarray}\label{eq:dt_probability_fast_slow}
f(t) = p_{s} \cdot p_{f} \cdot (\nu_{s} + \nu_{f} + \nu_{dc} ) \cdot e^{- (\nu_{s} + \nu_{f} + \nu_{dc}) \cdot t} + \\ \nonumber
p_{s} \cdot (1 - p_{f}) \cdot (\nu_{s} + \nu_{dc}) \cdot e^{- (\nu_{s} + \nu_{dc}) \cdot t} + \\ \nonumber
p_{f} \cdot (1 - p_{s}) \cdot (\nu_{f} + \nu_{dc}) \cdot e^{- (\nu_{f} + \nu_{dc}) \cdot t} + \\ \nonumber
(1 - p_{s}) \cdot (1 - p_{f}) \cdot \nu_{dc} \cdot e^{- \nu_{dc} \cdot t}
\end{eqnarray}

Формула (\ref{eq:dt_probability_fast_slow}) действительна лишь в том случае, если измеряются расстояния между сигналами, вызванными срабатыванием одной ячейки.
Сигналы, вызванные одновременным срабатыванием двух и более ячеек (т.к. из-за кросстока) не должны рассматриваться при нахождении плотности временных интервалов.

В статье \cite{After-pulsingandcross-talkinmulti-pixelphotoncounters} приведен другой результат для плотности временных интервалов, отличный от полученного в данной работе,
т.к. они предполагали, что имеется еще один процесс - delayed cross-talk. Однако на практике вероятность delayed cross-talk значительно ниже, чем вероятность direct cross-talk и
в наших измерениях мы его не наблюдали. Про другие процессы, которые вызывают срабатывание ячейки можно найти в \cite{Modeling crosstalk and afterpulsing in siliconphoto multipliers}.

\subsection{Signal finder}

Схема установки для записи сигнала с SiPM представлена на рис.\ref{image:install_V_bd_22}.

\begin{figure}[h]
\center{\includegraphics[width=8cm]{install_V_bd_22}}
\caption{Схема установки для записи сигнала с SiPM}
\label{image:install_V_bd_22}
\end{figure}


Данные в сыром формате записывались на компьютер посредством осциллографа Tektronix DPO 4104B.
При записи триггер отсутствовал. Длина непрерывной записи была 5MS при частоте оцифровки в 5GHz.
Для каждом напряжении и температуре на SiPM было записано 1000 файлов, т.е. 1 секунда сигнала.

Сигнал с SiMP можно представить как сумму одноэлектронных импульсов $Signal_{1e}(t - t_{i})$ со случайной амплитудой $A_{i}$ и временем возникновения $t_{i}$:

\begin{eqnarray}\label{eq:parsing}
V(t) = \sum \limits_{i = 0}^{N} A_{i} \cdot Signal_{1e}(t - t_{i}) + V_{0}
\end{eqnarray}

Форма одноэлектронного импульса находилась из анализа записанного сигнала и аппроксимировалась аналитической функцией.
Записанный сигнал обрабатывался по специальному алгоритму, который находил одноэлектронные импульсы без примеси послеимпульсов и усреднял их.
Отбрасывать сигналы с послеимпульсами необходимо для нахождения корректной формы сигнала.
Форма одноэлектронного спектра для различных SiPM показана на рис.\ref{image:signal_form_comparison}.
Форма сигнала была измерена при различных значениях перенапряжений (от 2 до 4.5 V) и температур (от -8 до 27 $C^{\circ}$), но оказалась практически неизменной.

\begin{figure}[h]
\center{\includegraphics[width=8cm]{signal_form_comparison}}
\caption{Форма одноэлектронных сигналов с различных SiPM.}
\label{image:signal_form_comparison}
\end{figure}

Далее одноэлектронные импульсы аппроксимировались функцией, полученной от свертки функции (\ref{eq:V(t)_base}) c функцией гаусса, описывающей вклад ограниченного быстродействия электроники.
Результат свертки представлен в формуле (\ref{eq:V(t)_conv}), где $\sigma$ - среднеквадратичное отклонение распределения гаусса.

\begin{eqnarray}\label{eq:V(t)_base}
V(t) = A \cdot \exp \left[- \frac{t - t_0}{\tau_{rec}} \right] \cdot \left( 1 - \exp \left[ -\frac{t - t_0}{\tau_{rise}} \right] \right) \cdot \theta(t - t_0) + V_0,
\end{eqnarray}
где $A$ - амплитуда импульса, $t_0$ - задержка по времени, $\tau_{rec}$ - искомое время восстановления ячейки,
$\tau_{rise}$ - время нарастания переднего фронта, $V_0$ - напряжение сдвига, $\theta(t - t_0)$ - функция Хевисайда.

\begin{eqnarray}\label{eq:V(t)_conv}
V(t) = V_0 + \frac{A}{2} \cdot \Bigg( \left\{ F(\sigma, \tau_{rec}) - F(\sigma, \tau_{total}) \right\} \Bigg), \text{ где} \\ \nonumber
F(\sigma, \tau) = \exp\left[ \frac{\sigma^2 - 2 t \cdot \tau}{2 \tau^2 } \right] \cdot \left( 1 + Erf \left[ \frac{t - \sigma^2 / \tau}{ \sigma \sqrt{2} } \right] \right), \\ \nonumber
\tau_{total} = \frac{\tau_{rec} \cdot \tau_{rise}}{\tau_{rec} + \tau_{rise}}
\end{eqnarray}

Зная форму одноэлектронного импульса, дальнейшая задача заключается в нахождении параметров $A_{i}$, $t_{i}$, а также параметра $N$, который характеризует число сигналов присутствующих в данном фрагменте данных. Файл можно разделить на множество независимых частей,
каждая из которых будет описывать сигнал по формуле (\ref{eq:parsing}) при различных параметрах $N$.
Для обработки сырых данных использовалась программа на языке C++.

Основная проблема, возникающая при обработке - наличие шума.
Существует множество цифровых фильтров, которые могут сгладить сигнал, однако их применение приведет к потере информации о послеимпульсах,
т.к. послеимпульсы имеют экспоненциальное распределение по времени и с большой вероятностью они будут происходить при малых временах,
когда напряжение на ячейке еще не восстановилось.

Однако точность нахождения сигналов можно улучшить, есть в алгоритм аппроксимации передавать начальные параметры, близкие к искомым.
Для этого считалась производная по сигналу с одновременным сглаживанием (фильтр Савицкого-Голея третьего порядка и числом точек равным 51 (10.2 нс) ).
Таким образом, информация о производной тоже участвовала при обработке.

Чтобы разделить записанный файл на множество независимых сигналов, использовался следующий алгоритм: \\
1) Вычислялась первая производная при помощи фильтра Савицкого-Голея. \\
2) Если производная и амплитуда оказывались выше пороговых значений $th_{der}$ и $th_{amp}^{start}$, то время, предшествующее этому событию на 20 нс, бралось как время старта сигнала.
Это условие необходимо для правильного вычисления базовой линии сигнала. В противном случае хвост от предыдущего сигнала исказит базовую линию. \\
3) Если после предыдущего шага проходило более 5 нс и уровень сигнала был ниже порога по амплитуде $th_{amp}^{stop}$,
а также впереди на 20 нс производная  была не выше порога $th_{der}$, то данное время считалось временем окончания сигнала.
Порог по амплитуде $th_{amp}^{stop}$ выбирался как пересечение сигнала с зашумленной базовой линией.

Чтобы определить порог, $th_{amp}^{start}$ построим график-лестницу при различных значениях мертвого времени $\tau_{amp}^{dead}$.
Пример приведен на рис.~\ref{image:Hamamatsu_S10362-11-100C_295K_1OV_amp_th} для Hamamatsu S10362-11-100C при $T = 295K$ и $V = 1 V$.
Порог для запуска по амплитуде $th_{amp}^{start}$ выбирается на уровне половины амплитуды одноэлектронного сигнала и соответствует примерно $0.02$.
Причем найденные пороги практически не зависят от выбора мертвого времени $\tau_{amp}^{dead}$.
Аналогичный график можно построить и для производной (рис.~\ref{image:Hamamatsu_S10362-11-100C_295K_1OV_der_th}).
При его построении отбирались лишь те сигналы, которые превышали амплитудный порог $th_{amp}^{stop} = 0.002$.
Это позволило увидеть лестничную структуру. Без использования условия на порог график был бы существенно искажен, т.к. шумы могут иметь производную,
значение которой сравнимо с производной сигнала.
Выше порога $4 \cdot 10^{-4}$ вклад шумов значительно подавлен.
Это значение и выбирается в качестве $th_{der}$.
При других значениях перенапряжения пороги $th_{der}$ и $th_{amp}^{start}$ будут другие.

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_295K_1OV_amp_th_eng}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_295K_1OV_der_th_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость числа найденных сигналов от порога по амплитуде и мертвого времени $\tau_{amp}^{dead}$ для
Hamamatsu S10362-11-100C при перенапряжении 1В и температуре 295К.}
\label{image:Hamamatsu_S10362-11-100C_295K_1OV_amp_th}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость числа найденных сигналов от порога по производной и мертвого времени $\tau_{amp}^{dead}$ для
Hamamatsu S10362-11-100C при перенапряжении 1В и температуре 295К. Отобраны лишь сигналы, превышающие порог $th_{amp}^{stop} = 0.002$}
\label{image:Hamamatsu_S10362-11-100C_295K_1OV_der_th}}
\end{figure}

В результате работы данного алгоритма файл с данными разбивается на множество независимых участков.
На каждом участке может находиться как один импульс, так и большее количество.
\subsection{Correlation analysis}

Чтобы найти параметры $A_{i}$ и $t_{i}$, данный участок необходимо аппроксимировать функцией (\ref{eq:parsing}).
Поскольку данная функция внутренне нелинейна по параметру $t_{i}$, то необходимо задать начальные параметры времени старта сигнала.
Для этого используется следующий алгоритм:\\
1) Если первая производная выше порога, то на участке, начиная с этого момента и заканчивая временем, большим на 5 нс,
ищется максимум производной. Время, при котором первая производная достигла максимума, далее будет использовано в качестве стартового значения параметра $t_{i}$. \\
2) Если первая производная ниже порогового значения и прошло более 5 нс, то разрешается поиск следующего превышения порога.\\

Далее каждый независимый участок аппроксимировался функцией (\ref{eq:parsing}) при $N = 1$.
Рассмотрим корреляцию между амплитудой и значением $\chi^2 / Dof$ (рис.~\ref{image:Hamamatsu_S10362-11-100C_295K_1V_Chi2_amp 1}).
Можно заметить несколько четко выделяющихся кластеров: $A_{1}$, $B_{1}$, $C_{1}$ и т.д.
Кластер $A_{1}$ соответствует одноэлектронным сигналам.
Кластеры $B_{1}$, $C_{1}$ и т.д. соответствуют событиям, когда одновременно сработали две, три и большее количество ячеек (cross-talk), причем эти сигналы расположены вдали от других сигналов.
Из-за этого они имеют низкое значение $\chi^2 / Dof$ при аппроксимации однокомпонентной функцией.
Остальные события со значением $\chi^2 / Dof > 4$ (будем обозначать множеством $Z_{1}$ ) соответствуют нескольким сигналам, расположенным на относительно небольшом расстоянии расстоянии друг от друга.

Далее аппроксимируем события из множества $Z_{1}$ функцией (\ref{eq:parsing}) при $N = 2$.
В том случае каждое событие будет характеризоваться четырьмя параметрами: $\chi^2 / Dof $, $amp_{1}$, $amp_{2}$ - амплитуды первого и второго сигнала, $\Delta t$ - расстояние между сигналами.
Для начала построим корреляцию между суммарной амплитудой $amp_{1} + amp_{2}$ и значением $\chi^2 / Dof $ (рис.~\ref{image:Hamamatsu_S10362-11-100C_295K_1_OV_Chi2_amp1_amp2}).

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_295K_1V_Chi2_amp_1}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_295K_1_OV_Chi2_amp1_amp2_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Корреляция амплитуда - $\chi^2 / Dof$ при аппроксимации всех найденных сигналов однокомпонентной функцией.
Сигнал получен с Hamamatsu S10362-11-100C при перенапряжении 1В и температуре 295К.}
\label{image:Hamamatsu_S10362-11-100C_295K_1V_Chi2_amp 1}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Корреляция амплитуда - $\chi^2 / Dof$ при аппроксимации множества $Z_{1}$ (см. рис.~\ref{image:Hamamatsu_S10362-11-100C_295K_1V_Chi2_amp 1}) двухкомпонентной функцией.
Сигнал получен с Hamamatsu S10362-11-100C при перенапряжении 1В и температуре 295К.}
\label{image:Hamamatsu_S10362-11-100C_295K_1_OV_Chi2_amp1_amp2}}
\end{figure}

В этом случае также можно выделить несколько характерных множеств: $A_{2}$, $B_{2}$, $C_{2}$ и т.д.
Более наглядное представление о сигналах, образующих эти множества, можно получить из корреляции $amp_{1} + amp_{2}$ и $\Delta t$, построенной для конкретного множества (рис.~\ref{image:Hamamatsu_S10362-11-100C_295K_1_OV_amp1_amp2_dt_A2} и рис.~\ref{image:Hamamatsu_S10362-11-100C_295K_1_OV_amp1_amp2_dt_B2}).

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_295K_1_OV_amp1_amp2_dt_A2_eng}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_295K_1_OV_amp1_amp2_dt_B2_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Корреляция расстояния между сигналами и суммарной амплитудой при аппроксимации множества $A_{2}$ (см. рис.~\ref{image:Hamamatsu_S10362-11-100C_295K_1_OV_Chi2_amp1_amp2}) двухкомпонентной функцией.
Сигнал получен с Hamamatsu S10362-11-100C при перенапряжении 1В и температуре 295К.}
\label{image:Hamamatsu_S10362-11-100C_295K_1_OV_amp1_amp2_dt_A2}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Корреляция расстояния между сигналами и суммарной амплитудой при аппроксимации множества $B_{2}$ (см. рис.~\ref{image:Hamamatsu_S10362-11-100C_295K_1_OV_Chi2_amp1_amp2}) двухкомпонентной функцией.
Сигнал получен с Hamamatsu S10362-11-100C при перенапряжении 1В и температуре 295К.}
\label{image:Hamamatsu_S10362-11-100C_295K_1_OV_amp1_amp2_dt_B2}}
\end{figure}

Множество $A_{2}$ составляют сигналы, которые условно разделяются на два множества: $\alpha_{1}$ и  $\beta_{1}$.
Множество $\alpha_{1}$ соответствует двум близкорасположенным сигналам, причем их суммарная амплитуда вдвое больше амплитуды одноэлектронного импульса.
Это означает, что эти сигналы пришли с разных ячеек и являются темновыми импульсами.
В тоже время сигналы из множества $\beta_{1}$ имеют амплитуду, зависящую от расстояния между сигналами.
Это означает, что первый сигнал был одноэлектронным, а последующий оказался послеимпульсом.
Аналогичную корреляцию можно построить и для множества $B_{2}$ (рис.~\ref{image:Hamamatsu_S10362-11-100C_295K_1_OV_amp1_amp2_dt_B2}).
В этом случае в множеству $\alpha_{2}$ будут принадлежать два близкорасположенных сигнала один их которых имеет одноэлектронную амплитуду,
а другой двойную амплитуду, т.е. вызванный одновременным срабатыванием двух ячеек из-за кросстока.
Множество $\beta_{2}$ содержит сигналы, которые можно разделить на две группы.
Первая группа образована сигналами, в которых вначале одновременно сработали две ячейки, а потом одна из ячеек дала послеимпульс.
Вторая группа образована сигналами, в которых вначале сработала одна ячейка, затем через некоторое время произошел послеимпульс, который вызвал кроссток.
Множества, аналогичные $A_{2}$ и $B_{2}$ с большой суммарной амплитудой, соответствуют событиям, когда одновременно сработало большее количество ячеек.

Далее построим спектр временных интервалов.
При его построении нужно учитывать лишь сигналы без кросстоков, чтобы потом аппроксимировать спектр функцией (\ref{eq:dt_probability_fast_slow}).
Это означает, что для нахождения спектра временных интервалов мы измеряем расстояния лишь между теми сигналами, которые попали в множества $A_{1}$ или $A_{2}$ (числом событий, попавших в множества $A_{3}$, $A_{4}$ и т.д., можно пренебречь).

В результате получим спектр временных интервалов, изображенный на рис.~\ref{image:Hamamatsu_S10362-11-100C_295K_1_OV_dt_spectrum}.
При аппроксимации спектра функцией (\ref{eq:dt_probability_fast_slow}) найдем параметры $p_{s}$, $p_f$, $\nu_{s}$, $\nu_{f}$, $\nu_{DC}$.
Для аппроксимации используется небинированный фит и пакет RooFit.

При временном интервале около 25 нс наблюдается изменение монотонности спектра.
Это связано с тем, что если послеимпульс происходит в ячейке через промежуток времени меньше 25 нс после предыдущего импульса,
то его амплитуда будет мала и такой импульс нельзя будет отличить от шумов. Из-за этого импульс будет распознан как однокомпонентный и он не даст вклада в малые времена.
Это приведет к искажению спектра.
Для правильной аппроксимации необходимо принимать во внимание только временные интервалы, больше некоторого "порогового" значения.
Чтобы уточнить это значение была проведена аппроксимация при различных пороговых значениях.
На рис.~\ref{image:Hamamatsu_S10362-11-100C 295K_1_OV_dt_spectrum_timecut} приведена зависимость параметра $\tau_{f}$ от "временного" порога.
Для данного типа SiMP при температуре 295K и перенапряжении 1 В был выбран порог в 25 нс.
При уменьшении перенапряжения "временной" порог увеличивается.

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_295K_1_OV_dt_spectrum}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_295K_1_OV_dt_spectrum_timecut_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Спектр временных интервалов, аппроксимированный функцией (\ref{eq:dt_probability_fast_slow}).
События с кросстоком не учитываются.
Сигнал получен с Hamamatsu S10362-11-100C при перенапряжении 1В и температуре 295К.}
\label{image:Hamamatsu_S10362-11-100C_295K_1_OV_dt_spectrum}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость времени быстрой компоненты послеимпульса от временного порога. Сигнал получен с Hamamatsu S10362-11-100C при перенапряжении 1В и температуре 295К.}
\label{image:Hamamatsu_S10362-11-100C 295K_1_OV_dt_spectrum_timecut}}
\end{figure}

\section{Results}
\subsection{Dark noise}
В результате аппроксимации спектра временных интервалов получены зависимости частоты темнового шума от температуры и перенапряжения (рис.\ref{image:Hamamatsu_S10362-11-100C_dc_vs_T}, \ref{image:Hamamatsu_S10362-11-100C_dc_vs_V}, \ref{image:Hamamatsu_S13360-3050CS_dc_vs_V_rus}, \ref{image:Hamamatsu_S13360-3050CS_dc_vs_V_rus}).
Зависимость частоты темновых токов от температуры выражается следующей формулой \cite{Characterization of SiPM: temperature dependencies}:
\begin{eqnarray}\label{eq:Hz_vs_temperature}
\nu(\Delta V = const, T) = A \cdot T^{3/2} \cdot \exp\left[ - \frac{E_g}{2 k_B \cdot T} \right],
\end{eqnarray}
где A - константа, зависящая от перенапряжения, материала и технологических параметров, T - абсолютная температура, $E_g$ - ширина запрещенной зоны, $k_B$ - константа Больцмана.
Зависимость частоты от перенапряжения выражается линейным законом:
\begin{eqnarray}\label{eq:Hz_vs_overvoltage}
\nu(\Delta V, T = const) = k \cdot \Delta V
\end{eqnarray}


\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_dc_vs_T_eng}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_dc_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость частоты темнового тока от температуры при фиксированном перенапряжении для
Hamamatsu S10362-11-100C. Данные аппроксимированы функцией (\ref{eq:Hz_vs_temperature}).}
\label{image:Hamamatsu_S10362-11-100C_dc_vs_T}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость частоты темнового тока от перенапряжения при фиксированной температуре для
Hamamatsu S10362-11-100C. Данные аппроксимированы линейной функцией (\ref{eq:Hz_vs_overvoltage}).}
\label{image:Hamamatsu_S10362-11-100C_dc_vs_V}}
\end{figure}

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S13360-3050CS_dc_vs_V_eng}
\hfill
\includegraphics[width=0.47\textwidth]{KETEK_PM1125NS_SB0_dc_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость частоты темнового тока от перенапряжения при фиксированной температуре для Hamamatsu S13360-3050CS.
Линии - аппроксимация частоты константой для разных температур.}
\label{image:Hamamatsu_S13360-3050CS_dc_vs_V_rus}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость частоты темнового тока от перенапряжения при фиксированной температуре для KETEK PM1125NS-SB0.
Линия - аппроксимация частоты линейной функцией.}
\label{image:KETEK_PM1125NS_SB0_dc_vs_V_rus}}
\end{figure}

Однако для Hamamatsu S13360-3050CS в эксперименте не удалось набрать достаточно статистики для её аппроксимации данным способом из-за их низкого уровня шума.
По той же причине для KETEK PM1125NS-SB0 получена лишь одна точка при максимальном уровне шумовых импульсов.

\subsection{Cross-talk}
В множестве $A_{1}$ (рис.~\ref{image:Hamamatsu_S10362-11-100C_295K_1V_Chi2_amp 1}) содержатся одноэлектронные импульсы.
В множестве $B_{1}$ содержатся импульсы, вызванные одновременным срабатыванием двух ячеек.
В множестве $C_{1}$ содержатся импульсы, вызванные одновременным срабатыванием трех ячеек.
В множестве $A_{2}$ (рис.~\ref{image:Hamamatsu_S10362-11-100C_295K_1_OV_Chi2_amp1_amp2}) содержатся импульсы, вызванные срабатыванием либо одной ячейки с последующим послеимпульсом, либо двух ячеек в разные моменты времени из-за темновых токов.
В множестве $B_{2}$ содержатся импульсы, вызванные либо одновременным срабатыванием двух ячеек срабатыванием с последующим послеимпульсом одной из ячеек, либо срабатыванием одной ячейки с последующим послеимпульсом, вызывающим кроссток.

На данный момент мы вычисляем вероятность кросстока следующим образом:
\begin{eqnarray}\label{eq:xtalk_general}
P_{X-talk} = ( N_{B_{1}} + N_{C_{1}} ) / (N_{A_{1}} + N_{B_{1}} + N_{C_{1}})
\end{eqnarray}
Это приближенная формула, т.к. необходимо учитывать тот факт, что небольшая часть событий с кросстоком будет содержаться в множествах $B_{2}$, $C_{2}$, $B_{3}$, $C_{3}$  и т.д.

Вероятность кросстока должна иметь в первом приближении квадратичную зависимость от перенапряжения.
Это объясняется тем, что вероятность кросстока $P_{x-talk}$ пропорциональна числу образовавшихся электронов в лавине $G$ и вероятности срабатывания ячейки от фотона $\varepsilon_{Geiger}$,
причем каждая из этих величин имеет линейную зависимость от перенапряжения(для величины $\varepsilon_{Geiger}$ зависимость отличается
от линейной при больших перенапряжениях \cite{Measurement of PDE of MPPC with different wavelengths of light}):
\begin{eqnarray}\label{eq:xtalk_prob_V2_reason}
P_{x-talk}(\Delta V) \propto  G(\Delta V) \cdot \varepsilon_{Geiger}(\Delta V)
\end{eqnarray}

Таким образом, будем аппроксимировать экспериментальные данные следующей зависимостью:
\begin{eqnarray}\label{eq:xtalk_vs_T_V}
P_{x-talk}(\Delta V, T) = k_{x-talk} \cdot \Delta V^2
\end{eqnarray}

Результаты обработки приведены на рис. \ref{image:Hamamatsu_S10362-11-100C_xtalk_vs_T}, \ref{image:Hamamatsu_S10362-11-100C_xtalk_vs_V}, \ref{image:Hamamatsu_S13360-3050CS_xtalk_vs_V_rus}, \ref{image:KETEK_PM1125NS_SB0_x-tlak_vs_V_rus}.

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_xtalk_vs_T_eng}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_xtalk_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности кросстока от температуры при фиксированном перенапряжении для
Hamamatsu S10362-11-100C.}
\label{image:Hamamatsu_S10362-11-100C_xtalk_vs_T}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности кросстока от перенапряжения при фиксированной температуре для
Hamamatsu S10362-11-100C. Данные аппроксимированы квадратичной функцией.}
\label{image:Hamamatsu_S10362-11-100C_xtalk_vs_V}}
\end{figure}

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S13360-3050CS_xtalk_vs_V_eng}
\hfill
\includegraphics[width=0.47\textwidth]{KETEK_PM1125NS_SB0_x-tlak_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности кросстока от перенапряжения при фиксированной температуре для
Hamamatsu S13360-3050CS. Данные аппроксимированы квадратичной функцией.}
\label{image:Hamamatsu_S13360-3050CS_xtalk_vs_V_rus}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности кросстока от перенапряжения при фиксированной температуре для
KETEK PM1125NS-SB0. Данные аппроксимированы квадратичной функцией.}
\label{image:KETEK_PM1125NS_SB0_x-tlak_vs_V_rus}}
\end{figure}


Исходя из экспериментальных данных, можно сделать вывод, что вероятность кросстока не зависит от температуры.

\subsection{Проверка модели 4-х соседей}
В статье \cite{Modeling crosstalk in silicon photomultipliers} отмечалось существование SiPM, которые не соответствуют модели 4-х соседей.
Модель 4-х соседей подразумевает, что сработавшая ячейка может вызвать срабатывание лишь 4-х ближайших ячеек.
В этом случае вероятность кросстока в соседней ячейке $p$ связана с полной вероятность кросстока $P_{x-talk}$ следующим соотношением:
\begin{eqnarray}\label{eq:p vs xtalk}
(1 - p)^4 = 1 - P_{X-talk}
\end{eqnarray}

Знание величины $p$ необходимо, чтобы правильно посчитать мат. ожидание и дисперсию числа фотоэлектронов.
Полную вероятность кросстока рассчитаем по формуле (\ref{eq:xtalk_general}).
Далее вычислим величину $p$ из (\ref{eq:p vs xtalk}).
Затем вычислим вероятность того, что из-за кросстока сработала одна дополнительная ячейка: $p_{2 p.e.}^{theory} = 4 \cdot p \cdot q^6$.
С другой стороны, аналогичную вероятность $p_{2 p.e.}^{exp}$ можно вычислить как отношение числа событий $N_{2 p.e.}$ к полному числу событий.
В результате измерений было обнаружено, что отношение $p_{2 p.e.}^{exp} / p_{2 p.e.}^{theory}$ для Hamamatsu S10362-11-100C изменяется в зависимости от температуры и перенапряжения в интервале от 1 до 1.08, а для Hamamatsu S13360-3050CS и KETEK PM1125NS-SB0 данное отношение лежит в интервале от 0.98 до 1.02.
Таким образом можно сделать вывод, что модель 4-х соседей работает хорошо для всех рассмотренных типов SiPM.

\subsection{Послеимпульсы}
В результате аппроксимации спектра временных интервалов мы находим также вероятности и времена послеимпульсов.
Полученные данные приведены на рис.~\ref{image:Hamamatsu_S10362-11-100C_p_f_vs_T}, \ref{image:Hamamatsu_S10362-11-100C_p_f_vs_V}, \ref{image:Hamamatsu_S10362-11-100C_p_s_vs_T}, \ref{image:Hamamatsu_S10362-11-100C_p_s_vs_V}, \ref{image:Hamamatsu_S10362-11-100C_tau_f_vs_T}, \ref{image:Hamamatsu_S10362-11-100C_tau_f_vs_V}, \ref{image:Hamamatsu_S10362-11-100C_tau_s_vs_T},
 \ref{image:Hamamatsu_S10362-11-100C_tau_s_vs_V}, \ref{image:Hamamatsu_S13360-3050CS_p_f_vs_V_rus}, \ref{image:Hamamatsu_S13360-3050CS_tau_s_vs_V}, \ref{image:KETEK_PM1125NS_SB0_p_f_vs_V_rus}, \ref{image:KETEK_PM1125NS_SB0_tau_f_vs_V_rus}.

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_p_f_vs_T_eng}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_p_f_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности быстрой компоненты послеимпульса $p_{f}$ от температуры при фиксированном перенапряжении для
Hamamatsu S10362-11-100C.}
\label{image:Hamamatsu_S10362-11-100C_p_f_vs_T}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности быстрой компоненты послеимпульса $p_{f}$ от перенапряжения при фиксированной температуре для
Hamamatsu S10362-11-100C. Данные аппроксимированы квадратичной функцией.}
\label{image:Hamamatsu_S10362-11-100C_p_f_vs_V}}
\end{figure}

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_p_s_vs_T_eng}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_p_s_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности медленной компоненты послеимпульса $p_{s}$ от температуры при фиксированном перенапряжении для
Hamamatsu S10362-11-100C.}
\label{image:Hamamatsu_S10362-11-100C_p_s_vs_T}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности медленной компоненты послеимпульса $p_{s}$ от перенапряжения при фиксированной температуре для
Hamamatsu S10362-11-100C. Данные аппроксимированы квадратичной функцией.}
\label{image:Hamamatsu_S10362-11-100C_p_s_vs_V}}
\end{figure}

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_tau_f_vs_T_eng}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_tau_f_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость времени быстрой компоненты послеимпульса $\tau_{f}$ от температуры при фиксированном перенапряжении для
Hamamatsu S10362-11-100C.}
\label{image:Hamamatsu_S10362-11-100C_tau_f_vs_T}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость времени быстрой компоненты послеимпульса $\tau_{f}$ от перенапряжения при фиксированной температуре для
Hamamatsu S10362-11-100C.}
\label{image:Hamamatsu_S10362-11-100C_tau_f_vs_V}}
\end{figure}

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_tau_s_vs_T_eng}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_tau_s_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость времени медленной компоненты послеимпульса $\tau_{s}$ от температуры при фиксированном перенапряжении для
Hamamatsu S10362-11-100C.}
\label{image:Hamamatsu_S10362-11-100C_tau_s_vs_T}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость времени медленной компоненты послеимпульса $\tau_{s}$ от перенапряжения при фиксированной температуре для
Hamamatsu S10362-11-100C.}
\label{image:Hamamatsu_S10362-11-100C_tau_s_vs_V}}
\end{figure}


\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S13360-3050CS_p_f_vs_V_eng}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S13360-3050CS_tau_f_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности быстрой компоненты послеимпульса $p_{f}$ от перенапряжения при фиксированной температуре для
Hamamatsu S13360-3050CS. Данные аппроксимированы квадратичной функцией.}
\label{image:Hamamatsu_S13360-3050CS_p_f_vs_V_rus}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость времени быстрой компоненты послеимпульса $\tau_{f}$ от перенапряжения при фиксированной температуре для
Hamamatsu S13360-3050CS.}
\label{image:Hamamatsu_S13360-3050CS_tau_s_vs_V}}
\end{figure}

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{KETEK_PM1125NS_SB0_p_f_vs_V_eng}
\hfill
\includegraphics[width=0.47\textwidth]{KETEK_PM1125NS_SB0_tau_f_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности быстрой компоненты послеимпульса $p_{f}$ от перенапряжения при фиксированной температуре для
KETEK PM1125NS-SB0. Данные аппроксимированы квадратичной функцией.}
\label{image:KETEK_PM1125NS_SB0_p_f_vs_V_rus}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость времени быстрой компоненты послеимпульса $\tau_{f}$ от перенапряжения при фиксированной температуре для
KETEK PM1125NS-SB0.}
\label{image:KETEK_PM1125NS_SB0_tau_f_vs_V_rus}}
\end{figure}

Вероятности послеимпульсов $p_{s}$ и $p_{f}$ при текущей точности измерения не зависят от температуры.
От перенапряжения вероятности послеимпульсов должны иметь квадратичную зависимость:
\begin{eqnarray}\label{eq:p_f_s_vs_T_V}
p_{i}(\Delta V, T) = k_{i}^{p} \cdot \Delta V^2
\end{eqnarray}

Времена послеимпульсов $\tau_{s}$ и $\tau_{f}$ при данной точности измерений не имеют зависимости от перенапряжения.

\section{Conclusions}
В работе описан алгоритм измерения напряжения пробоя, темновых токов, вероятности кросстоков и послеимпульсов, времен послеимпульсов для трех типов SiPM :
KETEK PM1125NS-SB0, Hamamatsu S10362-33-025C and Hamamatsu S13360-3050CS.

При достигнутой точности измерения в интервале температур от $0$ до $20 C^{\circ}$ вероятность кросстока, вероятность послеимпульса и время послеимпульса не зависят от температуры.
Была проведена проверка SiPM на соответствие модели 4-х соседей. Все три типа SiPM имеют отличие от модели менее, чем на 10\%.
Вероятность кросстока для Hamamatsu S10362-33-025C при рабочем перенапряжении (1 В) составляет около 12\%, для Hamamatsu S13360-3050CS и KETEK PM1125NS-SB0 (рабочее перенапряжение 4 В) состаляет около 6\%. Вероятность послеимпульса для Hamamatsu S10362-33-025C при рабочем перенапряжении составляет около 10\% (быстрая компонента) и 15\% (медленная компонента).
Для Hamamatsu S13360-3050CS и KETEK PM1125NS-SB0 из-за небольшой статистики была изучена только быстрая компонента, которая составляет около 10\%.
Время послеимпульса для Hamamatsu S10362-33-025C составляет около 35 нс (быстрая компонента) и 170 нс (медленная компонента), для Hamamatsu S13360-3050CS - 9 нс, для KETEK PM1125NS-SB0 - 28 нс.
Частота темновых шумов для Hamamatsu S10362-33-025C при рабочем напряжении и температуре $20  \;  ^{\circ}C$ составляет $300  \;  кГц / мм^2$, для Hamamatsu S13360-3050CS - $30 \; кГц / мм^2$, для KETEK PM1125NS-SB0 - $80 \; кГц / мм^2$.

Таким образом, на основании проделанных экспериментов, мы можем сделать вывод, что лучшим кандидатом для использования в счетных детекторах среди исследованных SiPM является Hamamatsu S13360-3050CS, который при прочих равных имеет меньшую частоту темновых токов и наименьшее время послеимпульса.

Помимо использованного алгоритма нахождения кросстоков, существует еще три метода.
Первый - измерение частоты появления импульсов в зависимости от порога по амплитуде.
Второй - интегрирование сигнала в определенном интервале времени и нахождение числа событий в пиках.
Третий - обратная свертка сигнала и аппроксимация спектра временных интервалов.
Первые два метода достаточно просты и могут использоваться в online анализе, однако они имеют серьезный недостаток -
с их помощью нельзя найти вероятность и время послеимпульса.
Третий метод и метод, использованный в данной работе требуют больших вычислительных мощностей, однако позволяют найти параметры послеимпульсов.



